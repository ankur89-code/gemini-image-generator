<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Gemini Image Generator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea { width: 100%; height: 100px; }
    img { max-width: 300px; margin: 10px 10px 0 0; border: 1px solid #ccc; }
    #loader { display: none; }
  </style>
</head>
<body>

<h1>Gemini Image Generator</h1>

<textarea id="prompt">an apple on white background</textarea><br><br>

<label>Images:</label>
<input type="number" id="count" value="1" min="1" max="4" /><br><br>

<button onclick="generate()">Generate</button>
<p id="loader">Generating… ⏳</p>

<div id="images"></div>

<script>
async function generate() {
  const prompt = document.getElementById("prompt").value;
  const count = Number(document.getElementById("count").value);

  document.getElementById("loader").style.display = "block";
  document.getElementById("images").innerHTML = "";

  const res = await fetch("/api/generate", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ prompt, count })
  });

  const data = await res.json();
  document.getElementById("loader").style.display = "none";

  if (data.error) {
    alert(data.error);
    return;
  }

  data.images.forEach(b64 => {
    const img = document.createElement("img");
    img.src = `data:image/png;base64,${b64}`;
    document.getElementById("images").appendChild(img);
  });
}
</script>

</body>
</html>
